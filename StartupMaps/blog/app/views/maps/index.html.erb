<!-- 
  # Definition: The API of the map.
  # Input: Void.
  # Output: Google Map.
  # Author: Alia Tarek.
-->

<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>


<!-- 
  # Definition: The method that calls the markers.
  # Input: Name of the action and the id of the checkbox.
  # Output: The markers on the map.
  # Author: Alia Tarek.
-->

<script>
  var locationsMap = {};
  function toggleLocations(cb, url){
    var id = cb.id;
    if(!cb.checked){
      locationsMap[id] = [];
      buildMap();
      }
    else{
      $.ajax(url)
      .done(function(data) {
        locationsMap[id] = data;
        buildMap();
         if (locationsMap[id] == "")
        {alert("No result found")}
       })
      .fail(function(data) {
        alert.log( "error" );
      });
    }
  };
</script>


<!-- 
  # Definition: The checkboxes.
  # Input: The url of the actions.
  # Output: Checkboxes with the markers pictures.
  # Author: Alia Tarek.
-->

<h1>Startup Map</h1>
<h1 align=right>
<label>  <img src="http://rideforclimate.com/nukes/all/images/blue.png">  <input type='checkbox' id='startups' onclick='toggleLocations(this, "/maps/1/show_startups");'>Startups</label><br>
<label><img src="http://rideforclimate.com/nukes/all/images/orange.png">   <input type='checkbox'id='investors' onclick='toggleLocations(this, "/maps/1/show_investors");'>Investors</label><br>
<label><img src="http://rideforclimate.com/nukes/all/images/green.png">  <input type='checkbox'id='services' onclick='toggleLocations(this, "/maps/1/show_services");'>Services</label></h1>

<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'></div>
</div>


<!-- 
  # Definition: The Mapbuilder.
  # Input: Arrays of the markers.
  # Output: Map with the markers.
  # Author: Alia Tarek.
-->
 
<script type = "text/javascript">
  locationsMap["startups"] = [];
  locationsMap["investors"] = [];
  locationsMap["services"] = [];
  function buildMap (){
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
    var loc1 = locationsMap["startups"]
      .concat(locationsMap["investors"]);
    var loc2 = loc1.concat(locationsMap["services"]);
    markers = handler.addMarkers(loc2);
    handler.bounds.extendWith(markers);
    handler.fitMapToBounds();
    handler.getMap().setZoom(2);
  }); 
}
  buildMap();
</script>